function init(){var o="http://104.131.78.132:80/",t=o+"api/",e="http://35.2.78.140:8080/",n="u1";window.keyEnum={enter:13,rightArrow:39,leftArrow:37,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57};["<video",'src="http://104.131.78.132:80/static/test.m3u8"','height="400" width="700"','id="vid" autoplay="true"',"onabort=\"console.log(' ABORT ')\"","oncanplay=\"console.log(' CAN PLAY ')\"","oncanplaythrough=\"console.log(' CAN PLAY THROUGH' )\"","oncuechange=\"console.log(' CUE CHANGE ')\"","ondurationchange=\"console.log(' DURATION CHANGE ')\"","onemptied=\"console.log(' EMPTIED ')\"","onended=\"console.log( 'ENDED' )\"","onerror=\"console.log(' ERROR' )\"","onloadeddata=\"console.log(' LOADED DATA ')\"","onloadedmetadata=\"console.log(' LOADED METADATA ')\"","onloadstart=\"console.log(' LOAD START ')\"","onpause=\"console.log(' PAUSE ')\"","onplay=\"console.log(' PLAY ')\"","onplaying=\"console.log(' PLAYING ')\"","onprogress=\"console.log(' PROGRESS ')\"","onratechange=\"console.log(' RATE CHANGE ')\"","onseeked=\"console.log(' SEEKED ')\"","onseeking=\"console.log(' SEEKING ')\"","onstalled=\"console.log(' STALLED ')\"","onsuspend=\"console.log(' SUSPEND ')\"","onvolumechange=\"console.log(' VOLUME CHANGE ')\"","onwaiting=\"console.log(' WAITING ')\">","</video>"].join(" ");document.body.className="";var l,a=function(o,t){navigator.setResolution&&navigator.setResolution(1280,720),navigator.setWebSecurityEnabled&&navigator.setWebSecurityEnabled(!1),window.onkeydown=this.handleControlKey,window.test=this,this.accordion={index:0},this.scope=o,this.state="",this.http=t,this.carers=[],this.inCall=!1;var e=l=this;this.stayAlive=setInterval(function(){e.populateCarers(),e.pingOnline(),e.populateCalling()},1e3),e.populateCarers(),e.pingOnline(),e.populateCalling()};a.prototype.populateCalling=function(){var o=this;this.http({method:"GET",url:t+"isCalling/"+n+"/"}).success(function(e,l,a,s){if(e.isCalling&&!o.inCall){if(o.http({method:"GET",url:t+"uncall/"+n+"/"}),o.state="connecting")return;o.startCall()}})},a.prototype.startCall=function(){this.state="dialing",console.log(this.state),setTimeout(function(){return"dialing"==l.state||""==l.state?(console.log("Cancelling call"),l.state=""):void l.http({method:"GET",url:e+"itv/startURL?url="+o+"call"})},15e3)},a.prototype.endCall=function(){self.inCall=!1},a.prototype.populateCarers=function(){var o=this;this.http({method:"GET",url:t+"isCaredBy/"+n+"/"}).success(function(t,e,n,l){if(o.carers.length)for(var a=0;a<o.carers.length;a++)o.carers[a].active=t.users[a].active;else o.carers=t.users})},a.prototype.handleControlKey=function(o){var t=o.keyCode;if(t==keyEnum.enter&&(l.startCall(),"accordion"==l.state)){l.carers[l.accordion.index]}39==t&&(l.accordion.index=(l.carers.length+l.accordion.index+1)%l.carers.length),47==t&&(l.accordion.index=(l.carers.length+l.accordion.index-1)%l.carers.length,o.preventDefault()),40==t&&(l.state=l.state?"":"accordion",o.preventDefault()),49==t&&"dialing"==l.state&&(l.state="connecting"),50==t&&"dialing"==l.state&&(l.state=""),56==t&&(l.state="dialing",l.startCall()),l.scope.$apply()},a.prototype.pingOnline=function(){};var s,i=function(o,t){s=this,this.http=t,window.onkeydown=this.handleControlKey};i.prototype.handleControlKey=function(t){var n=t.keyCode;49==n&&s.http({method:"GET",url:e+"itv/startURL?url="+o}).success(function(){l.http({method:"GET",url:e+"drv/play?uniqueId=84&playFrom=offset&offset=250"})})};var r=function(o){o.startSymbol("[["),o.endSymbol("]]")};angular.module("livesaver",[]).config(["$interpolateProvider",r]).controller("main",["$scope","$http",a]).controller("call",["$scope","$http",i]),angular.bootstrap(document.body,["livesaver"])}