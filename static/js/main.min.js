function init(){var t="http://104.131.146.161:80/",o=t+"api/",e="http://35.2.78.140:8080/",n="u1";window.keyEnum={enter:13,rightArrow:39,leftArrow:37,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57};["<video",'src="http://104.131.78.132:80/static/test.m3u8"','height="400" width="700"','id="vid" autoplay="true"',"onabort=\"console.log(' ABORT ')\"","oncanplay=\"console.log(' CAN PLAY ')\"","oncanplaythrough=\"console.log(' CAN PLAY THROUGH' )\"","oncuechange=\"console.log(' CUE CHANGE ')\"","ondurationchange=\"console.log(' DURATION CHANGE ')\"","onemptied=\"console.log(' EMPTIED ')\"","onended=\"console.log( 'ENDED' )\"","onerror=\"console.log(' ERROR' )\"","onloadeddata=\"console.log(' LOADED DATA ')\"","onloadedmetadata=\"console.log(' LOADED METADATA ')\"","onloadstart=\"console.log(' LOAD START ')\"","onpause=\"console.log(' PAUSE ')\"","onplay=\"console.log(' PLAY ')\"","onplaying=\"console.log(' PLAYING ')\"","onprogress=\"console.log(' PROGRESS ')\"","onratechange=\"console.log(' RATE CHANGE ')\"","onseeked=\"console.log(' SEEKED ')\"","onseeking=\"console.log(' SEEKING ')\"","onstalled=\"console.log(' STALLED ')\"","onsuspend=\"console.log(' SUSPEND ')\"","onvolumechange=\"console.log(' VOLUME CHANGE ')\"","onwaiting=\"console.log(' WAITING ')\">","</video>"].join(" ");document.body.className="";var l,a=function(t,o){navigator.setResolution&&navigator.setResolution(1280,720),navigator.setWebSecurityEnabled&&navigator.setWebSecurityEnabled(!1),window.onkeydown=this.handleControlKey,window.test=this,this.accordion={index:0},this.scope=t,this.state="",this.http=o,this.carers=[],this.inCall=!1;var e=l=this;this.stayAlive=setInterval(function(){e.populateCarers()},4e3),e.populateCarers(),e.populateCalling()};a.prototype.populateCalling=function(){var t=this;this.http({method:"GET",url:o+"isCalling/"+n+"/"}).success(function(e,l,a,s){if(e.isCalling&&!t.inCall){if(t.http({method:"GET",url:o+"uncall/"+n+"/"}),t.state="connecting")return;t.startCall()}})},a.prototype.startCall=function(){this.state="dialing",console.log(this.state),setTimeout(function(){return"connecting"!=l.state?(console.log("Cancelling call"),l.state=""):void l.http({method:"GET",url:e+"itv/startURL?url="+t+"call"})},15e3)},a.prototype.endCall=function(){self.inCall=!1},a.prototype.populateCarers=function(){var t=this;this.http({method:"GET",url:o+"isCaredBy/"+n+"/"}).success(function(o,e,n,l){if(t.carers.length)for(var a=0;a<t.carers.length;a++)t.carers[a].active=o.users[a].active;else t.carers=o.users})},a.prototype.handleControlKey=function(o){var n=o.keyCode;if(55==n&&(l.state="messages"),n==keyEnum.enter&&(l.startCall(),"accordion"==l.state)){l.carers[l.accordion.index]}39==n&&(l.accordion.index=(l.carers.length+l.accordion.index+1)%l.carers.length),47==n&&(l.accordion.index=(l.carers.length+l.accordion.index-1)%l.carers.length,o.preventDefault()),40==n&&(l.state=l.state?"":"accordion",o.preventDefault()),49==n&&"messages"==l.state&&l.http({method:"GET",url:e+"itv/startURL?url="+t+"message"}),50==n&&"messages"==l.state&&(l.state=""),49==n&&"dialing"==l.state&&(l.state="connecting"),50==n&&"dialing"==l.state&&(l.state=""),56==n&&(l.state="dialing",l.startCall()),l.scope.$apply()};var s,r=function(t,o){s=this,this.http=o,window.onkeydown=this.handleControlKey};r.prototype.handleControlKey=function(o){var n=o.keyCode;49==n&&s.http({method:"GET",url:e+"itv/startURL?url="+t}).success(function(){s.http({method:"GET",url:e+"drv/play?uniqueId=84&playFrom=offset&offset=250"})})};var i,c=function(t,o){i=this,this.http=o,window.onkeydown=this.handleControlKey};c.prototype.handleControlKey=function(o){var n=o.keyCode;49==n&&i.http({method:"GET",url:e+"itv/startURL?url="+t}).success(function(){i.http({method:"GET",url:e+"drv/play?uniqueId=84&playFrom=offset&offset=250"})})};var d=function(t){t.startSymbol("[["),t.endSymbol("]]")};angular.module("livesaver",[]).config(["$interpolateProvider",d]).controller("main",["$scope","$http",a]).controller("call",["$scope","$http",r]).controller("message",["$scope","$http",c]),angular.bootstrap(document.body,["livesaver"])}