function init(){var o="http://104.131.78.132:80/api/",e="u1";window.keyEnum={enter:13,rightArrow:39,leftArrow:37,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57};var n=["<video",'src="http://104.131.78.132:80/static/test.m3u8"','height="400" width="700"','id="vid" autoplay="true"',"onabort=\"console.log(' ABORT ')\"","oncanplay=\"console.log(' CAN PLAY ')\"","oncanplaythrough=\"console.log(' CAN PLAY THROUGH' )\"","oncuechange=\"console.log(' CUE CHANGE ')\"","ondurationchange=\"console.log(' DURATION CHANGE ')\"","onemptied=\"console.log(' EMPTIED ')\"","onended=\"console.log( 'ENDED' )\"","onerror=\"console.log(' ERROR' )\"","onloadeddata=\"console.log(' LOADED DATA ')\"","onloadedmetadata=\"console.log(' LOADED METADATA ')\"","onloadstart=\"console.log(' LOAD START ')\"","onpause=\"console.log(' PAUSE ')\"","onplay=\"console.log(' PLAY ')\"","onplaying=\"console.log(' PLAYING ')\"","onprogress=\"console.log(' PROGRESS ')\"","onratechange=\"console.log(' RATE CHANGE ')\"","onseeked=\"console.log(' SEEKED ')\"","onseeking=\"console.log(' SEEKING ')\"","onstalled=\"console.log(' STALLED ')\"","onsuspend=\"console.log(' SUSPEND ')\"","onvolumechange=\"console.log(' VOLUME CHANGE ')\"","onwaiting=\"console.log(' WAITING ')\">","</video>"].join(" ");document.body.className="";var t,l=function(o,e){navigator.setResolution&&navigator.setResolution(1280,720),navigator.setWebSecurityEnabled&&navigator.setWebSecurityEnabled(!1),window.onkeydown=this.handleControlKey,window.test=this,this.accordion={index:0},this.scope=o,this.state="",this.http=e,this.carers=[],this.inCall=!1;var n=t=this;this.stayAlive=setInterval(function(){n.populateCarers(),n.pingOnline(),n.populateCalling()},1e3),n.populateCarers(),n.pingOnline(),n.populateCalling()};l.prototype.populateCalling=function(){var n=this;this.http({method:"GET",url:o+"isCalling/"+e+"/"}).success(function(t,l,a,s){t.isCalling&&(n.inCall||(n.http({method:"GET",url:o+"uncall/"+e+"/"}),n.startCall()))})},l.prototype.startCall=function(){this.state="dialing",console.log(this.state),setTimeout(function(){return"dialing"==t.state?(console.log("Cancelling call"),t.state=""):void angular.element(document.getElementById("hotbod")).append(n)},5e3)},l.prototype.endCall=function(){self.inCall=!1},l.prototype.populateCarers=function(){var n=this;this.http({method:"GET",url:o+"isCaredBy/"+e+"/"}).success(function(o,e,t,l){if(n.carers.length)for(var a=0;a<n.carers.length;a++)n.carers[a].active=o.users[a].active;else n.carers=o.users})},l.prototype.handleControlKey=function(o){var e=o.keyCode;if(e==keyEnum.enter&&(t.startCall(),"accordion"==t.state)){t.carers[t.accordion.index]}39==e&&(t.accordion.index=(t.carers.length+t.accordion.index+1)%t.carers.length),47==e&&(t.accordion.index=(t.carers.length+t.accordion.index-1)%t.carers.length,o.preventDefault()),40==e&&(t.state=t.state?"":"accordion",o.preventDefault()),49==e&&"dialing"==t.state&&(t.state="connecting"),50==e&&"dialing"==t.state&&(t.state=""),t.scope.$apply()},l.prototype.pingOnline=function(){};var a=function(o){o.startSymbol("[["),o.endSymbol("]]")};angular.module("livesaver",[]).config(["$interpolateProvider",a]).controller("main",["$scope","$http",l]),angular.bootstrap(document.body,["livesaver"])}