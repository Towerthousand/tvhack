function init(){var o="http://104.131.78.132:80/",t=o+"api/",e="u1";window.keyEnum={enter:13,rightArrow:39,leftArrow:37,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57};["<video",'src="http://104.131.78.132:80/static/test.m3u8"','height="400" width="700"','id="vid" autoplay="true"',"onabort=\"console.log(' ABORT ')\"","oncanplay=\"console.log(' CAN PLAY ')\"","oncanplaythrough=\"console.log(' CAN PLAY THROUGH' )\"","oncuechange=\"console.log(' CUE CHANGE ')\"","ondurationchange=\"console.log(' DURATION CHANGE ')\"","onemptied=\"console.log(' EMPTIED ')\"","onended=\"console.log( 'ENDED' )\"","onerror=\"console.log(' ERROR' )\"","onloadeddata=\"console.log(' LOADED DATA ')\"","onloadedmetadata=\"console.log(' LOADED METADATA ')\"","onloadstart=\"console.log(' LOAD START ')\"","onpause=\"console.log(' PAUSE ')\"","onplay=\"console.log(' PLAY ')\"","onplaying=\"console.log(' PLAYING ')\"","onprogress=\"console.log(' PROGRESS ')\"","onratechange=\"console.log(' RATE CHANGE ')\"","onseeked=\"console.log(' SEEKED ')\"","onseeking=\"console.log(' SEEKING ')\"","onstalled=\"console.log(' STALLED ')\"","onsuspend=\"console.log(' SUSPEND ')\"","onvolumechange=\"console.log(' VOLUME CHANGE ')\"","onwaiting=\"console.log(' WAITING ')\">","</video>"].join(" ");document.body.className="";var n,l=function(o,t){navigator.setResolution&&navigator.setResolution(1280,720),navigator.setWebSecurityEnabled&&navigator.setWebSecurityEnabled(!1),window.onkeydown=this.handleControlKey,window.test=this,this.accordion={index:0},this.scope=o,this.state="",this.http=t,this.carers=[],this.inCall=!1;var e=n=this;this.stayAlive=setInterval(function(){e.populateCarers(),e.pingOnline(),e.populateCalling()},1e3),e.populateCarers(),e.pingOnline(),e.populateCalling()};l.prototype.populateCalling=function(){var o=this;this.http({method:"GET",url:t+"isCalling/"+e+"/"}).success(function(n,l,a,s){n.isCalling&&(o.inCall||(o.http({method:"GET",url:t+"uncall/"+e+"/"}),o.startCall()))})},l.prototype.startCall=function(){this.state="dialing",console.log(this.state),setTimeout(function(){return"dialing"==n.state||""==n.state?(console.log("Cancelling call"),n.state=""):void n.http({method:"GET",url:"http://35.2.78.140:8080/itv/startURL?url="+o+"call"})},15e3)},l.prototype.endCall=function(){self.inCall=!1},l.prototype.populateCarers=function(){var o=this;this.http({method:"GET",url:t+"isCaredBy/"+e+"/"}).success(function(t,e,n,l){if(o.carers.length)for(var a=0;a<o.carers.length;a++)o.carers[a].active=t.users[a].active;else o.carers=t.users})},l.prototype.handleControlKey=function(o){var t=o.keyCode;if(t==keyEnum.enter&&(n.startCall(),"accordion"==n.state)){n.carers[n.accordion.index]}39==t&&(n.accordion.index=(n.carers.length+n.accordion.index+1)%n.carers.length),47==t&&(n.accordion.index=(n.carers.length+n.accordion.index-1)%n.carers.length,o.preventDefault()),40==t&&(n.state=n.state?"":"accordion",o.preventDefault()),49==t&&"dialing"==n.state&&(n.state="connecting"),50==t&&"dialing"==n.state&&(n.state=""),n.scope.$apply()},l.prototype.pingOnline=function(){};var a,s=function(o,t){a=this,this.http=t,window.onkeydown=this.handleControlKey};s.prototype.handleControlKey=function(t){var e=t.keyCode;49==e&&a.http({method:"GET",url:"http://35.2.78.140:8080/itv/startURL?url="+o})};var i=function(o){o.startSymbol("[["),o.endSymbol("]]")};angular.module("livesaver",[]).config(["$interpolateProvider",i]).controller("main",["$scope","$http",l]).controller("call",["$scope","$http",s]),angular.bootstrap(document.body,["livesaver"])}