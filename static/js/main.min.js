function init(){var e="http://104.131.78.132:80/api/",t="u1";window.keyEnum={enter:13,rightArrow:39,leftArrow:37,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57};var n=["<video",'src="http://104.131.78.132:80/static/test.m3u8"','height="486" width="864"','id="vid" autoplay="true"',"onabort=\"writeScreen(' ABORT ')\"","oncanplay=\"writeScreen(' CAN PLAY ')\"","oncanplaythrough=\"writeScreen(' CAN PLAY THROUGH' )\"","oncuechange=\"writeScreen(' CUE CHANGE ')\"","ondurationchange=\"writeScreen(' DURATION CHANGE ')\"","onemptied=\"writeScreen(' EMPTIED ')\"","onended=\"writeScreen( 'ENDED' )\"","onerror=\"writeScreen(' ERROR' )\"","onloadeddata=\"writeScreen(' LOADED DATA ')\"","onloadedmetadata=\"writeScreen(' LOADED METADATA ')\"","onloadstart=\"writeScreen(' LOAD START ')\"","onpause=\"writeScreen(' PAUSE ')\"","onplay=\"writeScreen(' PLAY ')\"","onplaying=\"writeScreen(' PLAYING ')\"","onprogress=\"writeScreen(' PROGRESS ')\"","onratechange=\"writeScreen(' RATE CHANGE ')\"","onseeked=\"writeScreen(' SEEKED ')\"","onseeking=\"writeScreen(' SEEKING ')\"","onstalled=\"writeScreen(' STALLED ')\"","onsuspend=\"writeScreen(' SUSPEND ')\"","onvolumechange=\"writeScreen(' VOLUME CHANGE ')\"","onwaiting=\"writeScreen(' WAITING ')\">","</video>"].join("");document.body.className="";var r,o=function(e,t){navigator.setResolution&&navigator.setResolution(1280,720),navigator.setWebSecurityEnabled&&navigator.setWebSecurityEnabled(!1),window.onkeydown=this.handleControlKey,window.test=this,this.accordion={index:0},this.scope=e,this.state="",this.http=t,this.carers=[],this.inCall=!1;var n=r=this;this.stayAlive=setInterval(function(){n.populateCarers(),n.pingOnline(),n.populateCalling()},1e3),n.populateCarers(),n.pingOnline(),n.populateCalling()};o.prototype.populateCalling=function(){},o.prototype.startCall=function(){this.state="dialing",console.log(this.state),setTimeout(function(){angular.element(document.getElementById("video-container")).append(n)},15e3)},o.prototype.endCall=function(){self.inCall=!1},o.prototype.populateCarers=function(){var n=this;this.http({method:"GET",url:e+"isCaredBy/"+t+"/"}).success(function(e,t,r,o){if(n.carers.length)for(var i=0;i<n.carers.length;i++)n.carers[i].active=e.users[i].active;else n.carers=e.users})},o.prototype.handleControlKey=function(e){var t=e.keyCode;if(t==keyEnum.enter&&(r.startCall(),"accordion"==r.state)){r.carers[r.accordion.index]}39==t&&(r.accordion.index=(r.carers.length+r.accordion.index+1)%r.carers.length),47==t&&(r.accordion.index=(r.carers.length+r.accordion.index-1)%r.carers.length,e.preventDefault()),40==t&&(r.state=r.state?"":"accordion",e.preventDefault()),49==t&&"dialing"==r.state&&(r.state="connecting"),50==t&&"dialing"==r.state&&(r.state=""),r.scope.$apply()},o.prototype.pingOnline=function(){};var i=function(e){e.startSymbol("[["),e.endSymbol("]]")};angular.module("livesaver",[]).config(["$interpolateProvider",i]).controller("main",["$scope","$http",o]),angular.bootstrap(document.body,["livesaver"])}